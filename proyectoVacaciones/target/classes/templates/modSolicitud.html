<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="../static/css/themeIndex.css"
	th:href="@{/css/themeIndex.css}">
	 <link href="css/main.css" rel="stylesheet" type="text/css">
    <link href="icons/style.css" rel="stylesheet" type="text/css">
</head>

<body style="">
  <nav class="navbar navbar-expand-md navbar-dark bg-dark">
    <div class="container"> <a class="navbar-brand" href="#">
        <i class="fa d-inline fa-lg fa-stop-circle"></i>
        <b> HOLY D</b>
      </a> <button class="navbar-toggler navbar-toggler-right border-0" type="button" data-toggle="collapse" data-target="#navbar10">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbar10">
        <ul class="navbar-nav ml-auto">
          <li sec:authorize="hasRole('ROLE_ADMIN')" class="nav-item"> <a class="nav-link" href="#">SOLICITUDES EMPLEADOS</a> </li>
          <li sec:authorize="hasRole('ROLE_USER')" class="nav-item"> <a class="nav-link" th:href="@{/public/calendar}">Crear solicitud</a> </li>
          <li class="nav-item"> <a class="nav-link" href="#">Pricing</a> </li>
          <li class="nav-item"> <a class="nav-link" href="#">About</a> </li>
          <li class="nav-item"> <a class="nav-link" href="#">FAQ</a> </li>
        </ul> <a href="javascript:document.getElementById('logoutForm').submit()" class="btn navbar-btn ml-md-2 btn-light text-dark">LOG OUT</a>
      </div>
      <form th:action="@{/auth/logout}" method="POST" id="logoutForm"></form>
    </div>
  </nav>
  <div class="py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <h1 class=""> <span th:if="${developer.event.color != '#008000'}" th:text="${'Bienvenido ' + developer.name + ', ya tienes una solicitud en estado pendiente o anulada, puedes modificarla o anularla.'}"></span>
                         <span th:if="${developer.event.color == '#008000'}" th:text="${'Tu solicitud ha sido aprobada, disfruta de tus vacaciones!'}"></span>
            </h1>
        </div>
        <div class="col-md-6"></div>
      </div>
    </div>
  </div>
  <div class="py-5" style="">
    <div class="container">
      <div class="row">
        
        <div class="col-md-6" style="">
        <div class="main">
    <div style="float:left; width: 150px;">
        <div id="nav"></div>
    </div>
    <div style="margin-left: 150px;">
        <div class="space">

            <label><input type="checkbox" id="weekends" checked="checked"> Show weekend</label>
            <span style="margin-left: 30px;">
                Export as: <select id="format">
                    <option value="svg">SVG</option>
                    <option value="jpeg">JPEG</option>
                    <option value="png">PNG</option>
                </select>
                <button id="download">Download</button>
            </span>
        </div>

        <div id="dp"></div>
    </div>
</div>

        </div>
      </div>
    </div>
  </div>
  <div class="py-5">
    <div class="container">
      <div class="row">
        <div class="col-md-12"> </div> 
      </div>
    </div>
  </div>
  <div class="py-3">
    <div class="container">
      <div class="row">
        <div class="col-md-12 text-center">
          <p class="mb-0">Â© HOLY D. All rights reserved</p>
        </div>
      </div>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous" style=""></script>
  <script src="../static/js/daypilot/daypilot-all.min.js" th:src="@{/js/daypilot/daypilot-all.min.js}"></script>
<!-- jQuery -->
<script src="../static/js/jquery/jquery-3.2.1.min.js" th:src="@{/js/jquery/jquery-3.2.1.min.js}"></script>


<script th:inline="javascript">

    
 

    var dp = new DayPilot.Month("dp");
    dp.startDate = [[${event.start}]];
    dp.update();
    dp.init();
    dp.eventEndSpec = "Date";
    
    dp.onEventMove = function (args) {
        var params = {
            id: args.e.id(),
            start: args.newStart.toString(),
            end: args.newEnd.toString(),
            resource: args.newResource
        };
        $.ajax({
            type: 'POST',
            url: '/api/events/move',
            data: JSON.stringify(params),
            success: function (data) {
                dp.message("Moved");
            },
            contentType: "application/json",
            dataType: 'json'
        });
    };
    dp.onEventResize = function (args) {
        var params = {
            id: args.e.id(),
            start: args.newStart.toString(),
            end: args.newEnd.toString(),
            resource: args.e.resource()
        };
        $.ajax({
            type: 'POST',
            url: '/api/events/move',
            data: JSON.stringify(params),
            success: function (data) {
                dp.message("Resized");
            },
            contentType: "application/json",
            dataType: 'json'
        });
    };
    dp.onBeforeEventRender = function(args) {
        args.data.backColor = args.data.color;
        args.data.areas = [
            { top: 4, right: 4, width: 12, height: 14, icon: "icon-triangle-down", visibility: "Visible", action: "ContextMenu", style: "font-size: 12px; background-color: #fff; border: 1px solid #ccc; padding: 2px 2px 0px 2px; cursor:pointer;"}
        ];
    };
    dp.contextMenu = new DayPilot.Menu({
        items: [
            {
                text: "Delete",
                onClick: function(args) {
                    var e = args.source;
                    var params = {
                        id: e.id()
                    };
                    $.ajax({
                        type: 'POST',
                        url: '/api/events/delete',
                        data: JSON.stringify(params),
                        success: function (data) {
                            dp.events.remove(e);
                            dp.message("Deleted");
                            window.location.href = "/public/index";
                        },
                        contentType: "application/json",
                        dataType: 'json'
                    });
                }
            },
            {
                text: "-"
            },
            

        ]
    });
    dp.init();

    dp.events.load("/solicitudPendiente");


    function updateColor(e, color) {
        var params = {
            id: e.id(),
            color: color
        };
        $.ajax({
            type: 'POST',
            url: '/api/events/setColor',
            data: JSON.stringify(params),
            success: function (data) {
                e.data.color = color;
                dp.events.update(e);
            },
            contentType: "application/json",
            dataType: 'json'
        });
    }

    $(document).ready(function() {
        $("#weekends").click(function() {
            dp.showWeekend = $("#weekends").is(":checked");
            dp.update();
        });

        $("#download").click(function() {
            var format = $("#format").val();
            dp.exportAs(format).download();
        });
    });
    
   

</script>
 </body>

</html>